Jenkins Build
=============

-	Build 환경 설정
-	build.gradle
	-	node
-	branch regex
-	build pipeline
-	pipe 구성
-	shell script

(Git으로 형상관리가 되고 있는 Gradle 프로젝트를 기준으로 이 글이 작성되었습니다.)

개발환경과 어플리케이션 서버가 분리되어 있고, 여러 원격 서버를 가지고 있는 구성에서 어플리케이션을 배포하기는 굉장히 까다롭습니다.

### 구시대적 배포!

제가 겪어본 환경 기준으로 원시적인 배포 방법을 먼저 살펴보겠습니다. (자세한 git flow나 서버 환경은 생략)

1.	수정된 사항을 Git에 feature 브랜치에 Push 합니다.
2.	로컬 환경에서 프로젝트를 빌드합니다.
3.	빌드 완료된 추출물(jar 또는 war)를 테스트 서버로 옮깁니다.
4.	배포 스크립트를 실행 합니다.
5.	테스트를 진행합니다.(수정 사항이 있다면 1~5 반복)
6.	테스트 완료된 버전을 release 브랜치에 Push 합니다.
7.	버저닝 후 로컬 환경에서 프로젝트를 빌드합니다.
8.	다시 빌드 완료된 추출물을 중앙 관리 서버로 옮깁니다.
9.	중앙 배포 스크립트를 실행하여 QA 서버로 복사 및 배포 합니다.
10.	QA가 진행됩니다.(수정사항이 있다면 6~10 반복)
11.	중앙 배포 스크립트를 실행하여 Product로 복사 및 배포 합니다.(무중단 배포 포함)

자세한 과정은 거의 생략하였고 빌드나 원격 서버로 전송 등을 중점으로 기술하였습니다. 위 과정을 보면 푸시-빌드-전송-배포 과정이 굉장히 많습니다.

#### 문제점

**배포 flow 및 history**

현재 진행되고 있는 배포의 진행사항을 내가 직접 말로 해야만 한다. 나 또한 헷갈릴 수 있다.

누가 언제 배포했고, 어떤 이슈가 있었는지를 수기로 작성하여 확인해야 한다. 즉, 굉장히 귀찬고 속이기 쉬운 환경이다.

**개발 환경**

로컬에서 빌드가 되기 때문에 다른 사람이 코드를 한 글자라도 수정하여 배포하려면 해당 프로젝트에 맞는 개발 환경을 셋팅해야만 한다.

**테스트**

통합 테스트를 진행함에 로컬 환경을 믿을 수 있을까?

**귀찮다**

푸시-빌드-전송-배포를 계속해야 한다. 정말 귀찮다. 언급하지 않았지만 원격 서버로 빌드 추출물을 복사하는 depth가 굉장히 깊은 환경이 있다.

**그래서 저는 배포 자동화를 해보려 했습니다**

### Jenkins로 자동 배포 환경 만들기

Jenkins에 대한 설명은 굉장히 많기 때문에 생략하겠습니다.

일단 Jenkins를 올려야하고, Git과 연동이 필요합니다. 이에 대해서도 잘 정리된 창천향로님의 [docker를 활용한 CI 구축 연습하기(젠킨스,슬랙)](http://jojoldu.tistory.com/139)를 추천하여 대신합니다.

젠킨스의 배포 플로우를 중심으로 이 글을 작성합니다. **지극히 개인적으로 생각하여 진행한 플로우이기에 피드백을 기대합니다.**

#### 주 사용 Jenkins 플러그인

-	Build Pipeline Plugin

빌드 간 관계를 맺을 수

-	Parameterized Trigger Plugin
